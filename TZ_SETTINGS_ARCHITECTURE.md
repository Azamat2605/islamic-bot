# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ó–∞–¥–∞–Ω–∏–µ: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"

## 1. –¶–µ–ª—å –¢–ó
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ–π, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ä–∞–∑–¥–µ–ª–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –º–µ–Ω—é "üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å" (–∫–æ–º–∞–Ω–¥–∞ `/profile`) —á–µ—Ä–µ–∑ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å–∏—Å—Ç–µ–º—É Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã `/settings`.

## 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—è—Ö –ë–î

### 2.1 –¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å Settings
```python
class Settings(Base):
    __tablename__ = "settings"
    id: Mapped[int] = mapped_column(Integer, primary_key=True, autoincrement=True)
    user_id: Mapped[int] = mapped_column(BigInteger, ForeignKey("users.id"), nullable=False)
    language: Mapped[str] = mapped_column(String, default="ru")
    notification_on: Mapped[bool] = mapped_column(Boolean, default=True)
```

### 2.2 –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å Settings
```python
class Settings(Base):
    __tablename__ = "settings"
    
    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
    id: Mapped[int] = mapped_column(Integer, primary_key=True, autoincrement=True)
    user_id: Mapped[int] = mapped_column(BigInteger, ForeignKey("users.id"), nullable=False)
    language: Mapped[str] = mapped_column(String, default="ru")
    notification_on: Mapped[bool] = mapped_column(Boolean, default=True)
    
    # –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏
    timezone: Mapped[str] = mapped_column(String, default="Europe/Moscow")  # IANA timezone
    date_format: Mapped[str] = mapped_column(String, default="DD.MM.YYYY")  # 'DD.MM.YYYY' –∏–ª–∏ 'MM/DD/YYYY'
    time_format: Mapped[bool] = mapped_column(Boolean, default=True)  # True=24h, False=12h
    prayer_notifications_on: Mapped[bool] = mapped_column(Boolean, default=True)
    event_notifications_on: Mapped[bool] = mapped_column(Boolean, default=True)
    data_export_requested: Mapped[bool] = mapped_column(Boolean, default=False)
    account_deletion_requested: Mapped[bool] = mapped_column(Boolean, default=False)
    created_at: Mapped[DateTime] = mapped_column(DateTime, default=func.now())
    updated_at: Mapped[DateTime] = mapped_column(DateTime, default=func.now(), onupdate=func.now())
```

### 2.3 –ú–∏–≥—Ä–∞—Ü–∏—è
–°–æ–∑–¥–∞—Ç—å Alembic –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ —Ç–∞–±–ª–∏—Ü—É `settings`.

## 3. UI/UX –∏ –∏–µ—Ä–∞—Ä—Ö–∏—è Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä

### 3.1 –£—Ä–æ–≤–µ–Ω—å 1: –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –ü—Ä–æ—Ñ–∏–ª—è (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π)
```
üë§ –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚Ä¢ –î–Ω–µ–π –ø–æ–¥—Ä—è–¥: 7
üë§ –ê–∫–∫–∞—É–Ω—Ç:
   ‚Ä¢ –ò–º—è: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
   ‚Ä¢ –Æ–∑–µ—Ä–Ω–µ–π–º: @ivan
   ‚Ä¢ –ü–æ–ª: –ú—É–∂—Å–∫–æ–π
   ‚Ä¢ –ì–æ—Ä–æ–¥: –ú–æ—Å–∫–≤–∞
‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –í–∫–ª
   ‚Ä¢ –Ø–∑—ã–∫: RU

[–ò–∑–º–µ–Ω–∏—Ç—å –ü–æ–ª (–ú—É–∂—Å–∫–æ–π)] [–ò–∑–º–µ–Ω–∏—Ç—å –ì–æ—Ä–æ–¥ (–ú–æ—Å–∫–≤–∞)]
[‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏] [üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é]
```

**Callback_data:**
- `edit_gender` - —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
- `edit_city` - —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
- `settings_root` - –Ω–æ–≤—ã–π
- `main_menu` - —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π

### 3.2 –£—Ä–æ–≤–µ–Ω—å 2: –ö–æ—Ä–µ–Ω—å –ù–∞—Å—Ç—Ä–æ–µ–∫ (settings_root)
```
‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–∫:

[‚öôÔ∏è –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏]
[üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è]
[üóëÔ∏è –ê–∫–∫–∞—É–Ω—Ç –∏ –î–∞–Ω–Ω—ã–µ]
[‚Ü©Ô∏è –ù–∞–∑–∞–¥ –≤ –ü—Ä–æ—Ñ–∏–ª—å]
```

**Callback_data:**
- `settings_general` - –ø–µ—Ä–µ—Ö–æ–¥ –≤ –æ–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `settings_notifications` - –ø–µ—Ä–µ—Ö–æ–¥ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `settings_account` - –ø–µ—Ä–µ—Ö–æ–¥ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
- `back_to_profile` - –≤–æ–∑–≤—Ä–∞—Ç –≤ –ø—Ä–æ—Ñ–∏–ª—å

### 3.3 –£—Ä–æ–≤–µ–Ω—å 3: –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (settings_general)
```
‚öôÔ∏è –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

[üá∑üá∫ –Ø–∑—ã–∫: RU]
[‚è≥ –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å: Europe/Moscow]
[üìÖ –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã: DD.MM.YYYY]
[üïí –§–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏: 24h]
[‚Ü©Ô∏è –ù–∞–∑–∞–¥ –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∏]
```

**Callback_data:**
- `general_language` - –≤—ã–±–æ—Ä —è–∑—ã–∫–∞
- `general_timezone` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞
- `general_date_format` - –≤—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã
- `general_time_format` - –≤—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏
- `back_to_settings` - –≤–æ–∑–≤—Ä–∞—Ç –≤ –∫–æ—Ä–µ–Ω—å –Ω–∞—Å—Ç—Ä–æ–µ–∫

### 3.4 –£—Ä–æ–≤–µ–Ω—å 4: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (settings_notifications)
```
üîî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

[üîî –û–±—â–∏–µ: –í–∫–ª]
[üïå –ù–∞–º–∞–∑—ã: –í–∫–ª]
[üìÖ –°–æ–±—ã—Ç–∏—è: –í–∫–ª]
[‚Ü©Ô∏è –ù–∞–∑–∞–¥ –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∏]
```

**Callback_data:**
- `toggle_general_notifications` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `toggle_prayer_notifications` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –Ω–∞–º–∞–∑–∞—Ö
- `toggle_event_notifications` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–æ–±—ã—Ç–∏—è—Ö
- `back_to_settings` - –≤–æ–∑–≤—Ä–∞—Ç –≤ –∫–æ—Ä–µ–Ω—å –Ω–∞—Å—Ç—Ä–æ–µ–∫

### 3.5 –£—Ä–æ–≤–µ–Ω—å 5: –ê–∫–∫–∞—É–Ω—Ç –∏ –î–∞–Ω–Ω—ã–µ (settings_account)
```
üóëÔ∏è –ê–∫–∫–∞—É–Ω—Ç –∏ –î–∞–Ω–Ω—ã–µ

[üì§ –≠–∫—Å–ø–æ—Ä—Ç –º–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö]
[üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç]
[‚Ü©Ô∏è –ù–∞–∑–∞–¥ –≤ –ù–∞—Å—Ç—Ä–æ–π–∫–∏]
```

**Callback_data:**
- `account_export_data` - –∑–∞–ø—Ä–æ—Å —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
- `account_delete` - –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
- `back_to_settings` - –≤–æ–∑–≤—Ä–∞—Ç –≤ –∫–æ—Ä–µ–Ω—å –Ω–∞—Å—Ç—Ä–æ–µ–∫

## 4. –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### 4.1 –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å (Timezone)
**FSM —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** `TimezoneStates.entering_timezone`
**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å"
2. –ë–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–≤–µ—Å—Ç–∏ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Europe/Moscow" –∏–ª–∏ "+3")
3. –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `pytz` (—Å–ø–∏—Å–æ–∫ IANA timezones)
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ IANA ("Europe/Moscow") –∏–ª–∏ —á–∏—Å–ª–æ–≤–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è ("+3")
5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º

### 4.2 –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏
**–í–∞—Ä–∏–∞–Ω—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã:**
- `DD.MM.YYYY` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è RU)
- `MM/DD/YYYY` (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π)

**–í–∞—Ä–∏–∞–Ω—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏:**
- `24h` (True)
- `12h` (False)

### 4.3 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
**–¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
1. **–û–±—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** (`notification_on`) - —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø–æ–ª–µ
2. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞–º–∞–∑–∞—Ö** (`prayer_notifications_on`) - –Ω–æ–≤–æ–µ –ø–æ–ª–µ
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö** (`event_notifications_on`) - –Ω–æ–≤–æ–µ –ø–æ–ª–µ

**–õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è:**
- –ï–¥–∏–Ω—ã–π —Ö—ç–Ω–¥–ª–µ—Ä `toggle_setting` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–µ–π —Ç–∏–ø–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ü—Ä–∏–º–µ—Ä: `toggle_setting:general`, `toggle_setting:prayer`, `toggle_setting:event`

### 4.4 –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–≠–∫—Å–ø–æ—Ä—Ç –º–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö"
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `data_export_requested = True`
3. –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JSON/CSV —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏:
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è
   - –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
4. –§–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ Telegram
5. –§–ª–∞–≥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

### 4.5 –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç"
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `account_deletion_requested = True`
4. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è 30-–¥–Ω–µ–≤–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –æ–∂–∏–¥–∞–Ω–∏—è
5. –í —Ç–µ—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ
6. –ü–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Å—Ä–æ–∫–∞ - soft delete –¥–∞–Ω–Ω—ã—Ö

## 5. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 5.1 –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
1. **`bot/keyboards/inline/settings.py`** - –≤—Å–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - `settings_root_keyboard()` - –∫–æ—Ä–µ–Ω—å –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - `settings_general_keyboard(settings)` - –æ–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - `settings_notifications_keyboard(settings)` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - `settings_account_keyboard()` - –∞–∫–∫–∞—É–Ω—Ç –∏ –¥–∞–Ω–Ω—ã–µ
   - `language_keyboard()` - —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è, –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏
   - `timezone_keyboard()` - –≤—ã–±–æ—Ä –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–∞–π–º–∑–æ–Ω
   - `date_format_keyboard()` - –≤—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã
   - `time_format_keyboard()` - –≤—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏

2. **`bot/handlers/sections/settings_handlers.py`** - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - `settings_root_handler` - –∫–æ—Ä–µ–Ω—å –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - `settings_general_handler` - –æ–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - `settings_notifications_handler` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - `settings_account_handler` - –∞–∫–∫–∞—É–Ω—Ç –∏ –¥–∞–Ω–Ω—ã–µ
   - `toggle_setting_handler` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
   - `set_timezone_handler` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ (FSM)
   - `set_date_format_handler` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã
   - `set_time_format_handler` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏
   - `export_data_handler` - —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
   - `delete_account_handler` - —É–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞

3. **`bot/states/settings.py`** - FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
   ```python
   class TimezoneStates(StatesGroup):
       entering_timezone = State()
   
   class AccountStates(StatesGroup):
       confirming_deletion = State()
   ```

4. **`database/migrations/–≤–µ—Ä—Å–∏—è_—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ_settings.py`** - –º–∏–≥—Ä–∞—Ü–∏—è –ë–î

### 5.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

**–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `bot/keyboards/inline/profile.py`:**
```python
def profile_keyboard(user: User, settings: Settings) -> InlineKeyboardMarkup:
    builder = InlineKeyboardBuilder()
    
    # –†—è–¥ 1: –î–µ–π—Å—Ç–≤–∏—è (2 –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥)
    builder.row(...)  # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    
    # –†—è–¥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (2 –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥)
    builder.row(
        InlineKeyboardButton(
            text=_("‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏"),
            callback_data="settings_root",
        ),
        InlineKeyboardButton(
            text=_("üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"),
            callback_data="main_menu",
        ),
        width=2
    )
    
    return builder.as_markup()
```

**–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `bot/handlers/sections/profile_handlers.py`:**
- –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç `settings_root_keyboard`
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è `settings_root` callback

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ `bot/handlers/__init__.py`:**
```python
from .sections import settings_handlers

def get_handlers_router() -> Router:
    router = Router()
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–æ—É—Ç–µ—Ä—ã
    router.include_router(settings_handlers.router)
    return router
```

## 6. –°–ø–∏—Å–æ–∫ –Ω–æ–≤—ã—Ö Callback Data

### 6.1 –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
```
settings_root ‚Üí settings_general, settings_notifications, settings_account, back_to_profile
settings_general ‚Üí general_language, general_timezone, general_date_format, general_time_format, back_to_settings
settings_notifications ‚Üí toggle_general_notifications, toggle_prayer_notifications, toggle_event_notifications, back_to_settings
settings_account ‚Üí account_export_data, account_delete, back_to_settings
```

### 6.2 –î–µ–π—Å—Ç–≤–∏—è
```
general_language ‚Üí lang_ru, lang_en, lang_uk, back_to_general
general_timezone ‚Üí timezone_enter (FSM), timezone_list, back_to_general
general_date_format ‚Üí date_format_ddmmyyyy, date_format_mmddyyyy, back_to_general
general_time_format ‚Üí time_format_24h, time_format_12h, back_to_general

toggle_general_notifications ‚Üí toggle_setting:general
toggle_prayer_notifications ‚Üí toggle_setting:prayer
toggle_event_notifications ‚Üí toggle_setting:event

account_export_data ‚Üí export_confirm, export_cancel
account_delete ‚Üí delete_confirm, delete_cancel
```

## 7. –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ë–î**
   - –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ Settings
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

2. **–≠—Ç–∞–ø 2: –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã**
   - –°–æ–∑–¥–∞–Ω–∏–µ `bot/keyboards/inline/settings.py`
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–ª–∞–≤–∏–∞—Ç—É—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫

3. **–≠—Ç–∞–ø 3: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏**
   - –°–æ–∑–¥–∞–Ω–∏–µ `bot/handlers/sections/settings_handlers.py`
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

4. **–≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏"
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ä–æ—É—Ç–µ—Ä–µ

5. **–≠—Ç–∞–ø 5: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è FSM –¥–ª—è —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞

6. **–≠—Ç–∞–ø 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ edge cases

## 8. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å —É—á–µ—Ç–æ–º –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–∫** - –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –≤ –∏–µ—Ä–∞—Ä—Ö–∏—é
2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ Settings** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–∏–≥—Ä–∞—Ü–∏–∏
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –Ω–∞–º–∞–∑–æ–≤ –∏ —Å–æ–±—ã—Ç–∏–π —É–∂–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã
4. **–ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å** - –≤—Å–µ —Ç–µ–∫—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç i18n (`gettext as _`)

## 9. –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–¥–æ 100 –∫–Ω–æ–ø–æ–∫)
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —á–∞—Å—Ç—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –º–æ–≥—É—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å —Ä–∞–±–æ—Ç—É
3. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏** - –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –º–µ–Ω—é –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω—ã–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

## 10. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- **–ü–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é** —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –º–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** –¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **–£–¥–æ–±–Ω—ã–π UX** —á–µ—Ä–µ–∑ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** —á–µ—Ä–µ–∑ FSM –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- **–ü–æ–¥–¥–µ—Ä–∂–∫—É i18n** –¥–ª—è –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏

–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: **100%** (–≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã).
